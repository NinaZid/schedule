<?php session_start(); ?>
<?php if ( $_SESSION['role_id'] != 2){
 header("Location: admin.html");
} ?>
<?php include "check.php"; ?>
<?php include "calendar.php"; ?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Work Task Manager</title>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/calendar.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                            <a href="calendar.html" id="user-menu"><?php echo ucwords($_SESSION['first_name'] . ' ' . $_SESSION['last_name']); ?></a>
                    </li>
                    <li>
                        <a href="#" data-toggle="modal" data-target="#myModal" class="user-info" >Change Info</a>
                    </li>
                    <li>
                        <a href="logout.php">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Content -->
    <div class="container">
        <div class="col-lg-4" id="enterTasks">
            <div class="form-box">
                <div class="form-top">
                    <div class="form-top-left">
                        <h3>Enter your task:</h3>
                    </div>
                    <div class="form-top-right">
                        <i class="fa fa-lock"></i>
                    </div>
                </div>
                <div class="form-bottom">
                    <form role="form" action="" method="post" class="login-form">
                        <div class="form-group">
                          <label class="" for="">Day:</label>
                            <select class="form-control" name="day_select">
                              <option value="1">Monday</option>
                              <option value="2">Tuesday</option>
                              <option value="3">Wednesday</option>
                              <option value="4">Thursday</option>
                              <option value="5">Friday</option>
                            </select>
                        </div>
                        <div class="form-group">
                          <label class="" for="">Hour:</label>
                            <select class="form-control" name="hour_select">
                              <option value="9">09</option>
                              <option value="10">10</option>
                              <option value="11">11</option>
                              <option value="12">12</option>
                              <option value="13">13</option>
                              <option value="14">14</option>
                              <option value="15">15</option>
                              <option value="16">16</option>
                              <option value="17">17</option>
                            </select>
                        </div>
                        <div class="form-group">
                          <label class="" for="">Priority:</label>
                            <select class="form-control" name="info_select">
                              <option value="Danger">Danger</option>
                              <option value="Success">Success</option>
                              <option value="Info">Info</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="" for="">Task Name:</label>
                            <input type="text" class="form-text form-control" id="form-text" name="text_description" required="required">
                            <!--<input type="hidden" name="username" class="form-text form-control" value="<?php print $_POST['username'];?>">-->
                        </div>
                        <p id="status"><?php echo $status ?></p>
                        <button type="submit" class="btn" name="add_task" id="addTaskBtn">Add Task</button>
                        <button type="submit" class="btn" name="update_task" id="updateTaskBtn" disabled>Update Task</button>
                        <button type="submit" class="btn" name="delete_task" id="deleteTaskBtn" disabled>Delete Task</button>
                    </form>
                </div>
            </div>
        </div>
        <div class="row">
            <table class="table">
                <thead>
                  <tr class="days">
                    <th></th>
                    <th>Monday</th>
                    <th>Tusday</th>
                    <th>Wednesday</th>
                    <th>Thursday</th>
                    <th>Friday</th>
                  </tr>
                </thead>
                <tbody>
                <?php
                $data=getTasksById($_SESSION['id']);
                foreach (range(9,17) as $hour){ ?>
                  <tr class="">
                    <td class="hour"><?php echo $hour ?></td>
                      <?php foreach (range(1,5) as $day){?>
                      <td <?php if(isset($data[$day."_".$hour])){
                                   if($data[$day."_".$hour]['priority'] == 'Danger')
                                   { echo  'class="danger"';}
                                   elseif ($data[$day."_".$hour]['priority'] == 'Success')
                                   { echo 'class="success"';}
                                   else
                                   { echo 'class="info"';}}
                            ?> >
                      <?php
                      if(isset($data[$day."_".$hour])){
                      echo $data[$day."_".$hour]['name'];
                      }
                      ?>
                      </td>
                      <?php }?>
                  </tr>
                <?php }?>
                </tbody>
              </table>
        </div>
    </div>

    <!-- Modal -->
    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">User info</h4>
                </div>
                <div class="modal-body">
                    <?php $info=getUserById($_SESSION['id']); ?>
                    <label>First Name:</label>
                    <input type="text" class="form-text form-control" id="first-name" name="first-name" value="<?php echo $info['firstName']; ?>">
                    <label>Last Name:</label>
                    <input type="text" class="form-text form-control" id="last-name" name="last-name" value="<?php echo $info['lastName']; ?>">
                    <label>Password:</label>
                    <div class="password">
                    <input type="password" class="form-text form-control" id="password" name="password" value="<?php echo $info['password']; ?>">
                    <span class="glyphicon glyphicon-eye-open"></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-warning" data-dismiss="modal" name="update-btn" id="update-user-info">Update</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>

    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/scripts.js"></script>
</body>
</html>